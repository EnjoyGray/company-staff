{% extends "base.html" %} {% block content %} {% load custom_tags %}

<section class="mcontainer">
    {% comment %}
    <table class="table">
        <thead>
            <tr>
                <th scope="col"><a href="?ordering={% toggle_ordering current_ordering 'id' %}">ID</a></th>
                <th scope="col"><a href="?ordering={% toggle_ordering current_ordering 'name' %}">Name</a></th>
                <th scope="col"><a href="?ordering={% toggle_ordering current_ordering 'position__position_staff' %}">Position</a></th>
                <th scope="col"><a href="?ordering={% toggle_ordering current_ordering 'date_of_employment' %}">Time Employed</a></th>
                <th scope="col"><a href="?ordering={% toggle_ordering current_ordering 'salary' %}">Salary</a></th>
            </tr>
        </thead>
        <tbody class="table-group-divider">
            {% for w in table.items %}
            <tr>
                <th scope="row">{{ w.id }}</th>
                <td>{{ w.first_name }}</td>
                <td>{{ w.position.position_staff }}</td>
                <td>{{ w.date_of_employment }}</td>
                <td>{{ w.salary }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endcomment %} {% include "./includes/pagination.html" %}
</section>

<section class="mcontainer">
    <input type="text" id="search_here" class="form-control" placeholder="type here to search..." />
    <div id="box">
        {% for item in employers %}
        <b>{{ item.username }}
        <br />
        {% endfor %}
    </div>
</section>

<script>
    const data = "{{ qs_json }}";
    //console.log(data);

    const rdata = JSON.parse(data.replace(/&quot;/g, '"'));
    //console.log(rdata);

    const input = document.getElementById("search_here");
    //console.log(input);

    let filteredArr = [];

    input.addEventListener("keyup", (e) => {
        box.innerHTML = "";
        filteredArr = rdata.filter(info => info["username"].includes(e.target.value));
        //console.log(filteredArr);
        if (filteredArr.length > 0){
            filteredArr.map(info=>{
                box.innerHTML += `<b>${info['username']}</b><br>`;
            });
        } else {
            box.innerHTML = "<b>No results found...</b>"
        }
    });
</script>

{% endblock content %}
